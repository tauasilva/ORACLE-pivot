/*EXEMPLOS  DE USO DO PIVOT - ORACLE*/


CREATE TABLE TBL_EXEMPLO01(
COLUNA_ID INT,
COLUNA1_DESCRICAO VARCHAR(50),
COLUNA_VALOR VARCHAR(100) );


INSERT INTO TBL_EXEMPLO01 VALUES(1,'NOME','JO√ÉO')
INSERT INTO TBL_EXEMPLO01 VALUES(2,'SOBRENOME','SILVA');
INSERT INTO TBL_EXEMPLO01 VALUES(3,'IDADE','18');
INSERT INTO TBL_EXEMPLO01 VALUES(4,'CIDADE','PORTO ALEGRE');
INSERT INTO TBL_EXEMPLO01 VALUES(5,'BAIRRO','CENTRO');

COMMIT;

/*USO DO PIVOT*/
SELECT * FROM 
	(SELECT 
		COLUNA_VALOR,COLUNA1_DESCRICAO 
	FROM TBL_EXEMPLO01)
PIVOT 
(MAX(COLUNA_VALOR) 
 FOR COLUNA1_DESCRICAO IN 
	('NOME' AS PRIMEIRO_NOME,
	 'SOBRENOME' AS SOBRENOME,
	 'IDADE' AS IDADE,
	 'CIDADE' AS CIDADE,
	 'BAIRRO' AS BAIRRO));
	 

CREATE TABLE TBL_EXEMPLO02(
	COLUNA_ID INT,
	COLUNA1_ANO VARCHAR(50),
	COLUNA_MES VARCHAR(100),
	COLUNA_VALOR INT)


INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','JANEIRO',524);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','FEVEREIRO',564);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','MARCO',154);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','ABRIL',654);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','MAIO',325);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','JUNHO',654);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','JULHO',543);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','AGOSTO',23);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','STEMBRO',764);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','OUTUBRO',956);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','NOVEMBRO',989);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2018','DEZEMBRO',321);

INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','JANEIRO',2646);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','FEVEREIRO',231);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','MARCO',213);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','ABRIL',231);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','MAIO',325);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','JUNHO',123);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','JULHO',543);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','AGOSTO',8787);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','STEMBRO',764);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','OUTUBRO',564);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','NOVEMBRO',989);
INSERT INTO TBL_EXEMPLO02 VALUES(1,'2019','DEZEMBRO',321);




COMMIT

/*USO DO PIVOT*/
SELECT * FROM 
	(SELECT 
		COLUNA1_ANO,COLUNA_VALOR,COLUNA_MES
	FROM TBL_EXEMPLO02)
PIVOT 
(SUM(COLUNA_VALOR) 
 FOR COLUNA_MES IN( 
	'JANEIRO' AS JANEIRO,
	'FEVEREIRO' AS FEVEREIRO,
	'MARCO' AS MARCO,
	'ABRIL' AS ABRIL,
	'MAIO' AS MAIO,
	'JUNHO' AS JUNHO,
	'JULHO' AS JULHO,
	'AGOSTO' AS AGOSTO,
	'STEMBRO' AS STEMBRO, 
	'OUTUBRO' AS OUTUBRO,  
	'NOVEMBRO' AS NOVEMBRO,
	'DEZEMBRO' AS DEZEMBRO))
